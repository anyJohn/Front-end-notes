### OSI 七层协议

物理层、数据链路层、运输层、会话层、表示层、应用层

1. 物理层：物理机之间的通讯，网卡、集线器工作层。
2. 数据链路层：在不可靠的物理介质上提供可靠传输，接受物理层位流数据，封装成帧传递到上一层；也接受上层数据帧，拆分成位流转发到物理层。提供物理地址寻址功能。交换机工作层。
3. 网络层：将网络地址翻译成对应的物理地址，并决定如何将数据从发送方路由到接受方。路由器工作层（ip）。
4. 传输层：提供了进程之间的逻辑通讯，屏蔽了下面的网络层的核心细节，使得应用程序看起来像是在两个传输层实体之间有一条端到端的逻辑通讯信道（tcp、udp）。
5. 会话层：身份验证，权限鉴定，保持、断开会话。
6. 表示层：对数据格式进行编译，对收到或者发出的数据根据应用层的特征进行处理，对压缩文件解压，加密文件解密等。
7. 应用层：提供应用层协议（http、ftp、dns）。

### TCP、UDP 协议

#### 区别

TCP 作为面向流的协议，提供可靠的、面向连接的运输服务，并且提供点对点通信；UDP 作为面向报文的协议，不提供可靠交付，并且不需要连接，不仅仅对点对点，也支持多播和广播。

#### 为何 TCP 是可靠的

TCP 有三次握手建立连接，四次挥手关闭连接的机制。 除此之外还有滑动窗口和拥塞控制算法。最最关键的是还保留超时重传的机制。 对于每份报文也存在校验，保证每份报文可靠性。

#### 为何 UDP 是不可靠的

UDP 面向数据报无连接的，数据报发出去，就不保留数据备份了。 仅仅在 IP 数据报头部加入校验和复用。 UDP 没有服务器和客户端的概念。 UDP 报文过长的话是交给 IP 切成小段，如果某段报废报文就废了。

#### 三次握手过程

1. 第一次握手:客户端将标志位 SYN 置为 1，随机产生一个值序列号 seq=x，并将该数据包发送给服务端，客户端 进入 syn_sent 状态，等待服务端确认。
2. 第二次握手:服务端收到数据包后由标志位 SYN=1 知道客户端请求建立连接，服务端将标志位 SYN 和 ACK 都置为 1，ack=x+1,随机产生一个值 seq=y，并将该数据包发送给客户端以确认连接请求，服务端进入 syn_rcvd 状态。
3. 第三次握手:客户端收到确认后检查,如果正确则将标志位 ACK 为 1，ack=y+1，并将该数据包发送给服务端，服务端进行检查如果正确则连接建立成功，客户端和服务端进入 established 状态，完成三次握手，随后客户端和服务端之间可以开始传输数据了。

#### 四次挥手过程

1. 第一次挥手：客户端发送一个 FIN，用来关闭客户端到服务端的数据传送，客户端进入 fin_wait_1 状态。
2. 第二次挥手：服务端收到 FIN 后，发送一个 ACK 给客户端，确认序号为收到序号+1，服务端进入 Close_wait 状态。此时 TCP 连接处于半关闭状态，即客户端已经没有要发送的数据了，但服务端若发送数据，则客户端仍要接收。
3. 第三次挥手：服务端发送一个 FIN，用来关闭服务端到客户端的数据传送，服务端进入 Last_ack 状态。
4. 第四次挥手：客户端收到 FIN 后，客户端进入 Time_wait 状态，接着发送一个 ACK 给服务端，确认后，服务端进入 Closed 状态，完成四次挥手。

### DNS 协议

DNS 协议是基于 UDP 的应用层协议，功能是根据用户输入的域名，解析出该域名对应的 IP 地址，从而给客户端进行访问。

#### DNS 解析过程

1. 客户机发出访问请求，在本地计算机 HOSTS 文件中查询，如果没有找到，就会将请求发送递归 DNS 服务器（本地 DNS 服务器，localDNS）。
2. 递归 DNS 服务器在本地以及本地缓存中查找，找到返回地址，未找到询问根权威 DNS 服务器。
3. 根权威 DNS 服务器解析客户机查询的根域部分，把包含下一级的 DNS 服务器地址返回到递归 DNS 服务器。
4. 递归 DNS 服务器根据返回的信息，逐级递归查询，直到在有目标域名的服务器上得到相应的 IP 地址。
5. 递归 DNS 服务器将查询结构返回客户机。
6. 客户机根据得到的 ip 信息访问目标主机，解析完成。
